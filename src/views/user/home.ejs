<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>User Home</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
</head>
<body class="user-body">
  <div class="container">
    <!-- User Header/Navbar -->
    <div class="user-header">
      <div class="user-welcome">
        <h1>Hello, <%= user.email.split('@')[0] %>! ðŸ‘‹</h1>
        <p class="subtitle">Welcome to your dashboard</p>
      </div>
      <a href="/logout" class="btn btn-user-secondary">Logout</a>
    </div>

    <!-- User Dashboard Content -->
    <div class="user-dashboard">
      <!-- Welcome Card -->
      <div class="welcome-card">
        <div class="card-icon">ðŸŽ‰</div>
        <h2>Welcome to Your Home</h2>
        <p>You're successfully logged in! @<%= user.email %></p>
      </div>

      <!-- Info Cards Grid -->
      <div class="info-cards-grid">
        <div class="info-card">
          <div class="card-icon">ðŸ‘¤</div>
          <h3>Your Profile</h3>
          <p>Email: <%= user.email %></p>
          <p>Role: User</p>
        </div>

        <div class="info-card">
          <div class="card-icon">ðŸ”’</div>
          <h3>Account Security</h3>
          <p>Your account is secured with encrypted password protection.</p>
        </div>

        <div class="info-card">
          <div class="card-icon">âš¡</div>
          <h3>Quick Access</h3>
          <p>All your important features are just a click away.</p>
        </div>
      </div>

      <!-- Action Card -->
       <div class="action-card">
        <h3>Need Help?</h3>
        <p>If you have any questions or need assistance, feel free to contact our support team.</p>
        <button class="btn-user-primary" onclick="alert('Support feature coming soon!')">Contact Support</button>
      </div>
    </div> 
  </div>

  <script>
    function checkSession() {
      fetch('/check-session', {
        method: 'GET',
        credentials: 'include'
      })
        .then(response => response.json())
        .then(data => {
          if (!data.isAuthenticated || data.role !== 'user') {
            window.location.href = '/login';
          }
        })
        .catch(err => {
          console.error('Session check failed:', err);
          window.location.href = '/login';
        });
    }

    checkSession();

    window.addEventListener('pageshow', (event) => {
      if (event.persisted) {
        checkSession();
      }
    });
  </script>
</body>
</html>